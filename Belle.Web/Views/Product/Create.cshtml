@using Belle.Database.Enums
<div id="page-content">
        <!--MainContent-->
        <div id="MainContent" class="main-content" role="main">
            <!--Breadcrumb-->
            <div class="bredcrumbWrap">
                <div class="container breadcrumbs">
                    <a href="@Url.Action("Index", "Home")" title="Back to the home page">Home</a><span aria-hidden="true">›</span><span>Product create</span>
                </div>
            </div>
            <!--End Breadcrumb-->
                
            <div id="ProductSection-product-template" class="product-template__container prstyle2 container">
                <!--#ProductSection-product-template-->
                <div class="product-single product-single-1">
                    <div class="row">
                        <div class="col-ld-12 col-md-12 col-sm-12 col-12">
                            <div id="global-error-container" class="alert alert-danger d-none">Global error</div>
                        </div>
                        <div class="col-lg-6 col-md-6 col-sm-12 col-12">
                            <div class="product-details-img product-single__photos bottom">
                                <div class="zoompro-wrap product-zoom-right pl-20">
                                    <div class="zoompro-span">
                                        <img id="product-main-image" class="blur-up lazyload zoompro" src="" style="margin-top: 20px; margin-bottom: 15px;" />               
                                    </div>
                                </div>
                                @*<div class="product-thumb product-thumb-1">
                                    <div id="gallery" class="product-dec-slider-1 product-tab-left">
                                        <a data-image="~/images/product-detail-page/cape-dress-2.jpg" data-zoom-image="~/images/product-detail-page/cape-dress-2.jpg" class="slick-slide slick-cloned" data-slick-index="-3" aria-hidden="true" tabindex="-1">
                                            <img class="blur-up lazyload" src="~/images/product-detail-page/cape-dress-2.jpg" alt="" />
                                        </a>
                                        <a data-image="~/images/product-detail-page/cape-dress-3.jpg" data-zoom-image="~/images/product-detail-page/cape-dress-3.jpg" class="slick-slide slick-cloned" data-slick-index="-2" aria-hidden="true" tabindex="-1">
                                            <img class="blur-up lazyload" src="~/images/product-detail-page/cape-dress-3.jpg" alt="" />
                                        </a>
                                        <a data-image="~/images/product-detail-page/cape-dress-4.jpg" data-zoom-image="~/images/product-detail-page/cape-dress-4.jpg" class="slick-slide slick-cloned" data-slick-index="-1" aria-hidden="true" tabindex="-1">
                                            <img class="blur-up lazyload" src="~/images/product-detail-page/cape-dress-4.jpg" alt="" />
                                        </a>
                                        <a data-image="~/images/product-detail-page/cape-dress-5.jpg" data-zoom-image="~/images/product-detail-page/cape-dress-5.jpg" class="slick-slide slick-cloned" data-slick-index="0" aria-hidden="true" tabindex="-1">
                                            <img class="blur-up lazyload" src="~/images/product-detail-page/cape-dress-5.jpg" alt="" />
                                        </a>
                                        <a data-image="~/images/product-detail-page/cape-dress-6.jpg" data-zoom-image="~/images/product-detail-page/cape-dress-6.jpg" class="slick-slide slick-cloned" data-slick-index="1" aria-hidden="true" tabindex="-1">
                                            <img class="blur-up lazyload" src="~/images/product-detail-page/cape-dress-6.jpg" alt="" />
                                        </a>
                                        <a data-image="~/images/product-detail-page/cape-dress-7.jpg" data-zoom-image="~/images/product-detail-page/cape-dress-7.jpg" class="slick-slide slick-cloned" data-slick-index="2" aria-hidden="true" tabindex="-1">
                                            <img class="blur-up lazyload" src="~/images/product-detail-page/cape-dress-7.jpg" alt="" />
                                        </a>
                                        <a data-image="~/images/product-detail-page/cape-dress-8.jpg" data-zoom-image="~/images/product-detail-page/cape-dress-8.jpg" class="slick-slide slick-cloned" data-slick-index="3" aria-hidden="true" tabindex="-1">
                                            <img class="blur-up lazyload" src="~/images/product-detail-page/cape-dress-8.jpg" alt="" />
                                        </a>
                                    </div>
                                </div>*@
                                <div class="lightboximages">
                                    <a id="zoom-main-image" href="" data-size="1462x2048"></a>
                                    @*<a href="~/images/product-detail-page/camelia-reversible-big2.jpg" data-size="1462x2048"></a>
                                    <a href="~/images/product-detail-page/camelia-reversible-big3.jpg" data-size="1462x2048"></a>
                                    <a href="~/images/product-detail-page/camelia-reversible7-big.jpg" data-size="1462x2048"></a>
                                    <a href="~/images/product-detail-page/camelia-reversible-big4.jpg" data-size="1462x2048"></a>
                                    <a href="~/images/product-detail-page/camelia-reversible-big5.jpg" data-size="1462x2048"></a>
                                    <a href="~/images/product-detail-page/camelia-reversible-big6.jpg" data-size="731x1024"></a>
                                    <a href="~/images/product-detail-page/camelia-reversible-big7.jpg" data-size="731x1024"></a>
                                    <a href="~/images/product-detail-page/camelia-reversible-big8.jpg" data-size="731x1024"></a>
                                    <a href="~/images/product-detail-page/camelia-reversible-big9.jpg" data-size="731x1024"></a>
                                    <a href="~/images/product-detail-page/camelia-reversible-big10.jpg" data-size="731x1024"></a>*@
                                </div>
        
                                <div>
                                    <input class="form-control" type="file" id="formFile">
                                </div>

                            </div>
                            <!--Product Feature-->
                            <div id="photo-error-container" class="alert alert-danger d-none">Must be selected</div>
                            <div class="prFeatures">
                                <div class="row">
                                    <div class="col-12 col-sm-12 col-md-12 col-lg-6 feature">
                                        <img src="~/images/credit-card.png" alt="Safe Payment" title="Safe Payment" />
                                        <div class="details"><h3>Safe Payment</h3>Pay with the world's most payment methods.</div>
                                    </div>
                                    <div class="col-12 col-sm-12 col-md-12 col-lg-6 feature">
                                        <img src="~/images/shield.png" alt="Confidence" title="Confidence" />
                                        <div class="details"><h3>Confidence</h3>Protection covers your purchase and personal data.</div>
                                    </div>
                                    <div class="col-12 col-sm-12 col-md-12 col-lg-6 feature">
                                        <img src="~/images/worldwide.png" alt="Worldwide Delivery" title="Worldwide Delivery" />
                                        <div class="details"><h3>Worldwide Delivery</h3>FREE &amp; fast shipping to over 200+ countries &amp; regions.</div>
                                    </div>
                                    <div class="col-12 col-sm-12 col-md-12 col-lg-6 feature">
                                        <img src="~/images/phone-call.png" alt="Hotline" title="Hotline" />
                                        <div class="details"><h3>Hotline</h3>Talk to help line for your question on 4141 456 789, 4125 666 888</div>
                                    </div>
                                </div>
                            </div>
                            <!--End Product Feature-->
                        </div>
                        <div class="col-lg-6 col-md-6 col-sm-12 col-12">
                            <div class="product-single__meta">
                                @*<h1 class="product-single__title">Product Layout Style2</h1>*@
                                <p>Product name</p>
                                <input id="product-name" type="text" class="form-control" />
                                <div id="product-name-error-container" class="alert alert-danger d-none">Name error</div>
                                <br />
                                <span>Price</span>
                                <input class="form-control" type="number" id="product-price" />   
                                <p class="product-single__price product-single__price-product-template">
                                    @*<s id="ComparePrice-product-template"><span class="money">$900.00</span></s>*@
                                    @*<span class="product-price__price product-price__price-product-template product-price__sale product-price__sale--single">
                                        <span id="ProductPrice-product-template"><span class="money">$788.00</span></span>
                                    </span>
                                    <span class="discount-badge"> <span class="devider">|</span>&nbsp;
                                        <span>You Save</span>
                                        <span id="SaveAmount-product-template" class="product-single__save-amount">
                                        <span class="money">$100.00</span>
                                        </span>
                                        <span class="off">(<span>16</span>%)</span>
                                    </span>  *@
                                </p>
                                <p>Description</p>
                                <div id="descriptions-error-container" class="alert alert-danger d-none">Description error</div>
                                <textarea id="product-description" class="form-control" rows="10"></textarea>
                                <div class="swatch clearfix swatch-1 option2" data-option-index="1">
                                    <div class="product-form__item"> Category: 
                                            <select id="product-category" class="form-control" asp-items="@Html.GetEnumSelectList<ProductCategory>()"></select>
                                        </label>
                                    </div>
                                </div>
                                <div class="swatch clearfix swatch-1 option2" data-option-index="2">
                                    <div class="product-form__item"> Size:
                                            <select id="product-size" class="form-control" asp-items="@Html.GetEnumSelectList<ProductSize>()"></select>
                                        </label>
                                    </div>
                                </div>
                                <!-- Product Action -->
                                <div class="product-action clearfix">
                                    <div class="product-form__item--quantity">
                                        <div class="wrapQtyBtn">
                                            <div class="qtyField">
                                                <a class="qtyBtn minus" href="javascript:void(0);"><i class="fa anm anm-minus-r" aria-hidden="true"></i></a>
                                                <input type="text" id="Quantity" name="quantity" value="1" class="product-form__input qty">
                                                <a class="qtyBtn plus" href="javascript:void(0);"><i class="fa anm anm-plus-r" aria-hidden="true"></i></a>
                                            </div>
                                        </div>
                                    </div>                                
                                    <div class="product-form__item--submit">
                                        <button id="create-new-product-button" type="button" name="add" class="btn product-form__cart-submit">
                                            <span>Create a new product</span>
                                        </button>
                                    </div>
                                </div>
                        </div>
                            <!--Product Tabs-->
                            <div class="tabs-listing">
                                <div class="tab-container">
                                    <h3 class="acor-ttl active" rel="tab1">Product Details</h3>
                                    <div id="details-error-container" class="alert alert-danger d-none">Details error</div>
                                    <textarea id="product-details" class="form-control" rows="25"></textarea>
                                </div>
                            </div>
                            <!--End Product Tabs-->
                        </div>
                    </div>
            </div>
        <!--MainContent-->
    </div>
    <span id="site-scroll"><i class="icon anm anm-angle-up-r"></i></span>
</div>

@section Scripts {
<script>

$('#formFile').change((event) => {
    let files = event.target.files;
    console.log(files);
    $('#product-main-image').prop('src', URL.createObjectURL(files[0]));
    $('#zoom-main-image').prop('href', URL.createObjectURL(files[0]));
});

$('#create-new-product-button').on('click', () => {
    let formData = new FormData();
    formData.append('Photo', document.getElementById('formFile').files[0]);
    formData.append('Name', $('#product-name').val());
    formData.append('Price', Number($('#product-price').val()));
    formData.append('Description', $('#product-description').val());
    formData.append('Category', Number($('#product-category').val()));
    formData.append('Size', Number($('#product-size').val()));
    formData.append('Count', Number($('#Quantity').prop('value')));
    formData.append('Details', $('#product-details').val());

    $('#photo-error-container').addClass('d-none');
    $('#product-name-error-container').addClass('d-none');
    $('#descriptions-error-container').addClass('d-none');
    $('#details-error-container').addClass('d-none');
    $('#global-error-container').addClass('d-none');

    $.ajax({
        url: '@Url.Action("CreateAjax", "Product")',
        method: 'post',
        data: formData,
        contentType: false,
        processData: false,
        success: (response) => {
            location.href = response.redirectUrl;
        },
        error: (response) => {
            let responseJson = JSON.parse(response.responseText);

            if (responseJson.hasOwnProperty("Photo")) {
                $('#photo-error-container').removeClass('d-none');
                document.getElementById('photo-error-container').innerHTML = responseJson.Photo;
            }

            if (responseJson.hasOwnProperty("Name")) {
                $('#product-name-error-container').removeClass('d-none');
                document.getElementById('product-name-error-container').innerHTML = responseJson.Name;
            }

            if (responseJson.hasOwnProperty("Description")) {
                $('#descriptions-error-container').removeClass('d-none');
                document.getElementById('descriptions-error-container').innerHTML = responseJson.Description;
            }

            if (responseJson.hasOwnProperty("Details")) {
                $('#details-error-container').removeClass('d-none');
                document.getElementById('details-error-container').innerHTML = responseJson.Details;
            }

            if (responseJson.hasOwnProperty("responseMessage")) {
                $('#global-error-container').removeClass('d-none');
                document.getElementById('global-error-container').innerHTML = responseJson.responseMessage;
            }
        },
    })
    .done(() => {
        alert("Done!");
    })
});

$(function() {
    var $pswp = $('.pswp')[0],
        image = [],
        getItems = function() {
            var items = [];
            $('.lightboximages a').each(function() {
                var $href   = $(this).attr('href'),
                    $size   = $(this).data('size').split('x'),
                    item = {
                        src : $href,
                        w: $size[0],
                        h: $size[1]
                    }
                    items.push(item);
            });
            return items;
        }
    var items = getItems();
        
    $.each(items, function(index, value) {
        image[index]     = new Image();
        image[index].src = value['src'];
    });
    $('.prlightbox').on('click', function (event) {
        event.preventDefault();
              
        var $index = $(".active-thumb").parent().attr('data-slick-index');
        $index++;
        $index = $index-1;
        
        var options = {
            index: $index,
            bgOpacity: 0.9,
            showHideOpacity: true
        }
        var lightBox = new PhotoSwipe($pswp, PhotoSwipeUI_Default, items, options);
        lightBox.init();
    });
});
</script>
}